01/15/2024 00:14:58 - INFO - __main__ - ***** Running training *****
01/15/2024 00:14:58 - INFO - __main__ -   Num examples = 63704
01/15/2024 00:14:58 - INFO - __main__ -   Num Epochs = 100
01/15/2024 00:14:58 - INFO - __main__ -   Instantaneous batch size per device = 1
01/15/2024 00:14:58 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
01/15/2024 00:14:58 - INFO - __main__ -   Gradient Accumulation steps = 1
01/15/2024 00:14:58 - INFO - __main__ -   Total optimization steps = 6370400
Steps:   0%|                                                                                                                                   | 0/6370400 [00:00<?, ?it/s]01/15/2024 00:18:57 - INFO - validation.log_validation - Running validation image inference...
/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
Traceback (most recent call last):
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 321, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 135, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Users/miav1/.vscode/extensions/ms-python.python-2023.22.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
  File "main.py", line 587, in <module>
    main()
  File "main.py", line 377, in main
    log_validation(accelerator, val_image_dataloader, {"vae":vae,
  File "/Users/miav1/Desktop/university/2023/github/stable-diffusion-finetune/validation/log_validation.py", line 32, in log_validation
    val_batch = next(itervalloader)
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 674, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/Users/miav1/miniconda3/envs/sdtf/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/Users/miav1/Desktop/university/2023/github/stable-diffusion-finetune/dataset/visual_genome_dataset.py", line 76, in __getitem__
    image_data["captions"] = self.captions[image_id]
KeyError: '2390355'